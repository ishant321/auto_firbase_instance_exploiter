#!/bin/bash
GREEN='\033[0;32m'
NC='\033[0m'
directory="apkfiles"

for file in "$directory"/*; do
    #filename="$(basename "$file")"
    filename=$file
    foldername=$(echo $filename | cut -d '.' -f 1)
    #apktool d $filename -o $foldername > /dev/null 2>&1 -> to not get any output
    apktool d $filename -o $foldername > /dev/null 2>&1 # -> only error will show
    line=$(cat $foldername/res/values/strings.xml | grep 'firebase')
    link=$(echo $line | sed -n 's/.*https\(.*\)com.*/\1/p')
    fullLink1="https${link}com/.json"
    fullLink2="https${link}com/Users.json"
    res1=$(curl $fullLink1)
    res2=$(curl $fullLink2)
    echo "-------------------- $foldername --------------------"
    echo $fullLink1
    echo "${GREEN}$res1${NC}"
    echo $fullLink2
    echo "${GREEN}$res2${NC}"
    echo "---------------------------------------------"
    (rm -r $foldername)
done
